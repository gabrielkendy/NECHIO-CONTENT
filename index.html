<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NECHIO Content Studio 2026</title>
    <style>
        :root{--roxo:#8B2F8E;--roxo-dark:#6B1F6E;--verde:#1E8E3E;--preto:#0a0a0a;--preto2:#111;--preto3:#1a1a1a;--preto4:#222;--branco:#fff;--cinza:#888;--cinza2:#555;--verde-check:#22c55e;--azul:#3b82f6;--magenta:#a855f7;--laranja:#f97316}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',system-ui,sans-serif;background:var(--preto);color:var(--branco);min-height:100vh}
        .header{display:flex;justify-content:space-between;align-items:center;padding:15px 30px;background:linear-gradient(135deg,var(--preto2),var(--preto));border-bottom:1px solid #222;position:sticky;top:0;z-index:100}
        .logo{display:flex;align-items:center;gap:12px}
        .logo-icon{width:42px;height:42px;background:linear-gradient(135deg,var(--roxo),var(--roxo-dark));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:900;font-style:italic;box-shadow:0 4px 15px rgba(139,47,142,0.3)}
        .logo-text{font-size:20px;font-weight:900;letter-spacing:3px}
        .logo-sub{font-size:9px;color:var(--cinza);letter-spacing:1px}
        .header-actions{display:flex;gap:10px}
        .header-btn{padding:8px 16px;background:var(--preto3);border:1px solid #333;border-radius:6px;color:var(--branco);font-size:12px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:6px}
        .header-btn:hover{border-color:var(--roxo);background:rgba(139,47,142,0.1)}
        .header-btn.primary{background:var(--roxo);border-color:var(--roxo)}
        .layout{display:flex;height:calc(100vh - 72px)}
        .sidebar{width:280px;background:var(--preto2);border-right:1px solid #222;overflow-y:auto;padding:0}
        .month-filter{padding:20px;border-bottom:1px solid #222;background:var(--preto3)}
        .month-filter-title{font-size:10px;color:var(--cinza);letter-spacing:2px;margin-bottom:15px;display:flex;align-items:center;gap:8px}
        .month-filter-title::before{content:'';width:20px;height:2px;background:var(--roxo)}
        .month-selector-btn{width:100%;padding:15px 20px;background:linear-gradient(135deg,var(--preto4),var(--preto3));border:2px solid #333;border-radius:12px;color:var(--branco);cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:all .3s}
        .month-selector-btn:hover,.month-selector-btn.open{border-color:var(--roxo)}
        .month-selector-left{display:flex;align-items:center;gap:15px}
        .month-selector-num{font-size:28px;font-weight:900;color:var(--roxo);line-height:1}
        .month-selector-info h3{font-size:18px;font-weight:700}
        .month-selector-info span{font-size:11px;color:var(--cinza)}
        .month-selector-arrow{font-size:12px;color:var(--cinza);transition:transform .3s}
        .month-selector-btn.open .month-selector-arrow{transform:rotate(180deg)}
        .month-dropdown{position:absolute;top:100%;left:0;width:100%;background:var(--preto3);border:2px solid var(--roxo);border-top:none;border-radius:0 0 12px 12px;max-height:0;overflow:hidden;transition:max-height .3s;z-index:50}
        .month-dropdown.open{max-height:400px;overflow-y:auto}
        .month-dropdown-item{display:flex;align-items:center;gap:15px;padding:12px 20px;cursor:pointer;transition:all .2s;border-bottom:1px solid #222}
        .month-dropdown-item:hover{background:rgba(139,47,142,0.1)}
        .month-dropdown-item.active{background:rgba(139,47,142,0.2)}
        .month-dropdown-num{font-size:18px;font-weight:900;color:var(--roxo);width:30px}
        .month-dropdown-info h4{font-size:13px;font-weight:600}
        .month-dropdown-info span{font-size:10px;color:var(--cinza)}
        .month-dropdown-posts{margin-left:auto;background:var(--preto4);padding:4px 10px;border-radius:20px;font-size:10px;color:var(--cinza)}
        .month-quick-nav{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:15px}
        .month-quick-btn{padding:10px 5px;background:var(--preto4);border:1px solid #333;border-radius:8px;color:var(--cinza);font-size:10px;font-weight:600;cursor:pointer;transition:all .2s;text-align:center}
        .month-quick-btn:hover{border-color:var(--roxo);color:var(--branco)}
        .month-quick-btn.active{background:var(--roxo);border-color:var(--roxo);color:var(--branco)}
        .sidebar-info{padding:20px}
        .sidebar-info-title{font-size:10px;color:var(--cinza);letter-spacing:2px;margin-bottom:15px;display:flex;align-items:center;gap:8px}
        .sidebar-info-title::before{content:'';width:20px;height:2px;background:var(--verde)}
        .month-stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px}
        .month-stat-card{background:var(--preto3);border:1px solid #222;border-radius:10px;padding:15px;text-align:center}
        .month-stat-value{font-size:28px;font-weight:900;color:var(--roxo)}
        .month-stat-label{font-size:9px;color:var(--cinza);text-transform:uppercase;letter-spacing:1px}
        .month-theme-card{background:linear-gradient(135deg,rgba(139,47,142,0.1),var(--preto3));border:1px solid #333;border-radius:12px;padding:20px}
        .month-theme-label{font-size:9px;color:var(--roxo);letter-spacing:2px;margin-bottom:8px}
        .month-theme-title{font-size:22px;font-weight:900;margin-bottom:10px}
        .month-theme-desc{font-size:12px;color:var(--cinza);line-height:1.6}
        .month-selector{position:relative;width:100%}
        .main{flex:1;overflow-y:auto;padding:25px 30px}
        .main-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:20px;border-bottom:1px solid #222}
        .main-title{font-size:28px;font-weight:900;letter-spacing:2px}
        .main-title span{color:var(--roxo)}
        .posts-list{display:flex;flex-direction:column;gap:12px}
        .post-card{display:flex;align-items:center;gap:20px;padding:18px 20px;background:var(--preto2);border:1px solid #222;border-radius:12px;cursor:pointer;transition:all .25s}
        .post-card:hover{border-color:var(--roxo);transform:translateX(8px);box-shadow:0 5px 30px rgba(139,47,142,0.15)}
        .post-date{background:var(--preto3);border-radius:8px;padding:10px 12px;text-align:center;min-width:55px}
        .post-date-day{font-size:22px;font-weight:900;color:var(--roxo)}
        .post-date-month{font-size:9px;color:var(--cinza);text-transform:uppercase}
        .post-info{flex:1}
        .post-type{font-size:10px;color:var(--verde);font-weight:700;letter-spacing:1px;margin-bottom:5px}
        .post-title{font-weight:600;font-size:15px;margin-bottom:4px}
        .post-desc{font-size:12px;color:var(--cinza)}
        .post-format{background:var(--preto3);padding:6px 12px;border-radius:6px;font-size:10px;color:var(--cinza)}
        .modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:1000;overflow-y:auto;backdrop-filter:blur(10px)}
        .modal-overlay.show{display:block}
        .modal{max-width:1000px;margin:20px auto;background:var(--preto2);border-radius:16px;border:1px solid #333;overflow:hidden}
        .modal-header{padding:25px 30px;background:linear-gradient(135deg,var(--preto3),var(--preto2));border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:flex-start}
        .modal-header-left{flex:1}
        .modal-badge{display:inline-block;padding:4px 12px;background:rgba(139,47,142,0.2);border:1px solid var(--roxo);border-radius:20px;font-size:10px;color:var(--roxo);font-weight:700;letter-spacing:1px;margin-bottom:12px}
        .modal-title-row{display:flex;align-items:center;gap:15px;margin-bottom:8px;flex-wrap:wrap}
        .modal-date-input{background:var(--preto3);border:1px solid #444;border-radius:6px;padding:8px 12px;color:var(--branco);font-size:14px;width:140px}
        .modal-title-input{flex:1;min-width:200px;background:transparent;border:none;border-bottom:2px solid #333;color:var(--branco);font-size:18px;font-weight:700;padding:5px 0}
        .modal-title-input:focus{outline:none;border-bottom-color:var(--roxo)}
        .modal-desc{font-size:13px;color:var(--cinza)}
        .modal-close{width:40px;height:40px;background:var(--preto3);border:1px solid #444;border-radius:50%;color:#fff;font-size:18px;cursor:pointer;transition:all .2s}
        .modal-close:hover{border-color:var(--roxo);color:var(--roxo);transform:rotate(90deg)}
        .modal-tabs{display:flex;background:var(--preto3);border-bottom:1px solid #333;flex-wrap:wrap}
        .modal-tab{flex:1;min-width:120px;padding:15px 10px;background:transparent;border:none;color:var(--cinza);font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:6px;border-bottom:3px solid transparent}
        .modal-tab:hover{color:var(--branco);background:rgba(255,255,255,0.03)}
        .modal-tab.active{color:var(--roxo);border-bottom-color:var(--roxo);background:rgba(139,47,142,0.05)}
        .modal-tab-icon{font-size:14px}
        .modal-body{padding:25px 30px;max-height:60vh;overflow-y:auto}
        .content-section{margin-bottom:20px;background:var(--preto3);border-radius:12px;overflow:hidden}
        .section-header{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;background:var(--preto4);border-bottom:1px solid #333}
        .section-title{display:flex;align-items:center;gap:8px;font-size:11px;font-weight:700;letter-spacing:1px}
        .section-icon{font-size:14px}
        .section-title.narrativa{color:var(--azul)}
        .section-title.imagem{color:var(--magenta)}
        .section-title.video{color:var(--laranja)}
        .section-title.legenda{color:var(--verde-check)}
        .section-title.tela{color:var(--verde)}
        .copy-btn{display:flex;align-items:center;gap:6px;padding:6px 14px;background:var(--preto2);border:1px solid #444;border-radius:6px;color:var(--branco);font-size:10px;font-weight:600;cursor:pointer;transition:all .2s}
        .copy-btn:hover{background:var(--roxo);border-color:var(--roxo)}
        .copy-btn.copied{background:var(--verde-check);border-color:var(--verde-check)}
        .section-body{padding:18px}
        .content-text{font-size:13px;line-height:1.8;white-space:pre-wrap;color:#ddd;font-family:'Courier New',monospace;background:var(--preto);padding:15px;border-radius:8px;max-height:300px;overflow-y:auto}
        .toast{position:fixed;bottom:30px;right:30px;padding:15px 25px;background:var(--verde-check);color:#fff;border-radius:10px;font-weight:600;font-size:13px;transform:translateY(100px);opacity:0;transition:all .3s;z-index:2000;display:flex;align-items:center;gap:10px;box-shadow:0 10px 40px rgba(34,197,94,0.3)}
        .toast.show{transform:translateY(0);opacity:1}
        .empty-state{text-align:center;padding:80px 40px;color:var(--cinza)}
        .empty-state h3{font-size:20px;margin-bottom:10px;color:var(--cinza2)}
        .backup-info{padding:15px;background:var(--preto3);border-radius:8px;margin-top:15px;font-size:11px;color:var(--cinza)}
        .backup-info strong{color:var(--verde-check)}
        ::-webkit-scrollbar{width:6px}
        ::-webkit-scrollbar-track{background:var(--preto2)}
        ::-webkit-scrollbar-thumb{background:#333;border-radius:3px}
        ::-webkit-scrollbar-thumb:hover{background:var(--roxo)}
        @media(max-width:768px){.sidebar{display:none}.layout{flex-direction:column}.main{padding:15px}}
        
        /* ========== BOT√ïES DE A√á√ÉO NO MODAL ========== */
        .modal-action-btn{padding:8px 16px;border:1px solid #444;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;margin-left:10px;background:var(--preto3);color:var(--branco)}
        .modal-action-btn:hover{transform:translateY(-2px)}
        .btn-delete{background:#dc2626;border-color:#dc2626}
        .btn-delete:hover{background:#b91c1c}
        
        /* ========== BOT√ÉO DE STATUS ========== */
        .btn-status.completed{background:#16a34a;border-color:#16a34a}
        .btn-status.completed:hover{background:#15803d}
        .btn-status.pending{background:#ea580c;border-color:#ea580c}
        .btn-status.pending:hover{background:#c2410c}
        
        /* ========== BADGE DE STATUS NO CARD ========== */
        .post-status-badge{display:inline-block;padding:4px 10px;border-radius:12px;font-size:10px;font-weight:600;margin-top:8px}
        .status-completed{background:rgba(22,163,74,0.2);color:#16a34a;border:1px solid #16a34a}
        .status-pending{background:rgba(234,88,12,0.2);color:#ea580c;border:1px solid #ea580c}
        
        /* ========== BOT√ÉO DOWNLOAD ========== */
        .btn-download{background:#3b82f6;border-color:#3b82f6}
        .btn-download:hover{background:#2563eb}
        
        /* ========== MODAL GITHUB SYNC ========== */
        .github-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.95);z-index:2000;overflow-y:auto;backdrop-filter:blur(10px)}
        .github-modal.show{display:flex;align-items:center;justify-content:center}
        .github-modal-content{background:var(--preto2);border-radius:16px;border:1px solid var(--roxo);padding:30px;max-width:500px;width:90%;max-height:80vh;overflow-y:auto}
        .github-modal-title{font-size:22px;font-weight:900;margin-bottom:20px;color:var(--roxo);display:flex;align-items:center;gap:10px}
        .github-input{width:100%;padding:12px 15px;background:var(--preto3);border:1px solid #444;border-radius:8px;color:var(--branco);font-size:14px;margin-bottom:15px}
        .github-input:focus{outline:none;border-color:var(--roxo)}
        .github-input::placeholder{color:var(--cinza)}
        .github-label{display:block;margin-bottom:8px;font-size:12px;color:var(--cinza);font-weight:600}
        .github-btn{width:100%;padding:14px;background:var(--roxo);border:none;border-radius:8px;color:var(--branco);font-size:14px;font-weight:700;cursor:pointer;margin-top:10px;transition:all .2s}
        .github-btn:hover{background:var(--roxo-dark);transform:translateY(-2px)}
        .github-btn.secondary{background:var(--preto3);border:1px solid #444}
        .github-btn.secondary:hover{border-color:var(--roxo)}
        .github-close{position:absolute;top:15px;right:20px;background:none;border:none;color:var(--branco);font-size:24px;cursor:pointer}
        .github-status{padding:12px;background:var(--preto3);border-radius:8px;margin-top:15px;font-size:12px;color:var(--cinza);line-height:1.6}
        .github-status.success{border-left:3px solid var(--verde-check);color:var(--verde-check)}
        .github-status.error{border-left:3px solid #dc2626;color:#dc2626}
        .github-divider{height:1px;background:#333;margin:20px 0}
        .github-tabs{display:flex;gap:5px;margin-bottom:20px}
        .github-tab{flex:1;padding:10px;background:var(--preto3);border:1px solid #333;border-radius:8px;color:var(--cinza);font-size:11px;font-weight:600;cursor:pointer;text-align:center;transition:all .2s}
        .github-tab:hover{border-color:var(--roxo)}
        .github-tab.active{background:rgba(139,47,142,0.2);border-color:var(--roxo);color:var(--roxo)}
    </style>
</head>
<body>

<header class="header">
    <div class="logo">
        <div class="logo-icon">N</div>
        <div>
            <div class="logo-text">NECHIO</div>
            <div class="logo-sub">Content Studio 2026</div>
        </div>
    </div>
    <div class="header-actions">
        <button class="header-btn" onclick="exportData()">üíæ Backup</button>
        <button class="header-btn" onclick="document.getElementById('importFile').click()">üìÇ Importar</button>
        <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
        <button class="header-btn" onclick="loadFromURL()">üîó Carregar URL</button>
        <button class="header-btn" onclick="openGitHubSync()">‚ö° GitHub Sync</button>
        <button class="header-btn primary" onclick="saveToStorage()">‚úì Salvar</button>
    </div>
</header>

<div class="layout">
    <aside class="sidebar">
        <div class="month-filter">
            <div class="month-filter-title">SELECIONAR M√äS</div>
            <div class="month-selector">
                <button class="month-selector-btn" id="monthSelectorBtn" onclick="toggleDropdown()">
                    <div class="month-selector-left">
                        <div class="month-selector-num" id="selectorNum">01</div>
                        <div class="month-selector-info">
                            <h3 id="selectorName">Janeiro</h3>
                            <span id="selectorTheme">Ver√£o</span>
                        </div>
                    </div>
                    <div class="month-selector-arrow">‚ñº</div>
                </button>
                <div class="month-dropdown" id="monthDropdown"></div>
            </div>
            <div class="month-quick-nav" id="monthQuickNav"></div>
        </div>
        <div class="sidebar-info">
            <div class="sidebar-info-title">VIS√ÉO GERAL</div>
            <div class="month-stats">
                <div class="month-stat-card">
                    <div class="month-stat-value" id="statPosts">0</div>
                    <div class="month-stat-label">Posts</div>
                </div>
                <div class="month-stat-card">
                    <div class="month-stat-value" id="statStories">0</div>
                    <div class="month-stat-label">Stories</div>
                </div>
            </div>
            <div class="month-theme-card">
                <div class="month-theme-label">TEMA DO M√äS</div>
                <div class="month-theme-title" id="themeTitle">Ver√£o</div>
                <div class="month-theme-desc" id="themeDesc">Conte√∫do focado em produtos sazonais.</div>
            </div>
            <div class="backup-info">
                <strong>‚úì Auto-save ativo</strong><br>
                Dados salvos em localStorage.<br>
                Use "Backup" para exportar JSON.
            </div>
        </div>
    </aside>
    
    <main class="main">
        <div class="main-header">
            <h1 class="main-title" id="mainTitle">JANEIRO ‚Äî <span>Ver√£o</span></h1>
        </div>
        <div class="posts-list" id="postsList"></div>
    </main>
</div>

<div class="modal-overlay" id="modalOverlay">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-header-left">
                <div class="modal-badge" id="modalBadge">POST #01</div>
                <div class="modal-title-row">
                    <input type="date" class="modal-date-input" id="modalDate" onchange="updatePostDate()">
                    <input type="text" class="modal-title-input" id="modalTitle" placeholder="T√≠tulo..." onchange="updatePostTitle()">
                </div>
                <div class="modal-desc" id="modalDesc">Descri√ß√£o</div>
            </div>
            <button class="modal-action-btn btn-delete" onclick="deletePost()" title="Deletar este post">üóëÔ∏è Deletar</button>
            <button id="statusToggleBtn" class="modal-action-btn btn-status pending" onclick="togglePostStatus()" title="Alternar status">‚è≥ Em Andamento</button>
            <button class="modal-action-btn btn-download" onclick="downloadPost()" title="Baixar JSON deste post">‚¨áÔ∏è Baixar</button>
            <button class="modal-close" onclick="closeModal()">‚úï</button>
        </div>
        <div class="modal-tabs">
            <button class="modal-tab active" data-tab="narrativa" onclick="switchTab('narrativa')"><span class="modal-tab-icon">üìù</span> NARRATIVA</button>
            <button class="modal-tab" data-tab="imagem" onclick="switchTab('imagem')"><span class="modal-tab-icon">üñºÔ∏è</span> PROMPT IMAGEM</button>
            <button class="modal-tab" data-tab="video" onclick="switchTab('video')"><span class="modal-tab-icon">üé¨</span> PROMPT V√çDEO</button>
            <button class="modal-tab" data-tab="tela" onclick="switchTab('tela')"><span class="modal-tab-icon">üì∫</span> TEXTO TELA</button>
            <button class="modal-tab" data-tab="legenda" onclick="switchTab('legenda')"><span class="modal-tab-icon">üì±</span> LEGENDA</button>
        </div>
        <div class="modal-body" id="modalBody"></div>
    </div>
</div>

<div class="toast" id="toast">‚úì Copiado!</div>

<!-- MODAL GITHUB SYNC -->
<div class="github-modal" id="githubModal">
    <div class="github-modal-content">
        <h2 class="github-modal-title">‚ö° GitHub Sync</h2>
        
        <div class="github-tabs">
            <button class="github-tab active" onclick="switchGitHubTab('load')">üîó Carregar</button>
            <button class="github-tab" onclick="switchGitHubTab('push')">üì§ Atualizar</button>
        </div>
        
        <div id="githubLoadTab">
            <label class="github-label">URL do JSON (GitHub Raw ou qualquer URL)</label>
            <input type="text" class="github-input" id="jsonUrl" placeholder="https://raw.githubusercontent.com/usuario/repo/main/data.json">
            
            <button class="github-btn" onclick="loadFromURLInput()">üîÑ Carregar Dados</button>
            
            <div class="github-divider"></div>
            
            <button class="github-btn secondary" onclick="loadDefaultData()">üì¶ Carregar data.json Local</button>
        </div>
        
        <div id="githubPushTab" style="display:none">
            <label class="github-label">GitHub Token (com permiss√£o repo)</label>
            <input type="password" class="github-input" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
            
            <label class="github-label">Reposit√≥rio (usuario/repo)</label>
            <input type="text" class="github-input" id="githubRepo" placeholder="gabrielkendy/NECHIO-CONTENT" value="gabrielkendy/NECHIO-CONTENT">
            
            <label class="github-label">Arquivo a atualizar</label>
            <input type="text" class="github-input" id="githubFile" value="data.json" placeholder="data.json">
            
            <button class="github-btn" onclick="pushToGitHub()">üì§ Atualizar no GitHub</button>
        </div>
        
        <div class="github-status" id="githubStatus" style="display:none"></div>
        
        <div class="github-divider"></div>
        
        <button class="github-btn secondary" onclick="closeGitHubModal()">‚úï Fechar</button>
    </div>
</div>

<script>
// ============== DATABASE NECHIO 2026 ==============
const MONTHS_DATA = [
    {id:1,name:'Janeiro',theme:'Ver√£o e A√ßa√≠',shortTheme:'Ver√£o',posts:0,stories:0,desc:'Alta temporada de a√ßa√≠ e produtos refrescantes.'},
    {id:2,name:'Fevereiro',theme:'Carnaval e Festa',shortTheme:'Carnaval',posts:0,stories:0,desc:'Produtos para festas, eventos e catering.'},
    {id:3,name:'Mar√ßo',theme:'Volta √†s Aulas',shortTheme:'Escola',posts:0,stories:0,desc:'Produtos para cantinas e alimenta√ß√£o escolar.'},
    {id:4,name:'Abril',theme:'P√°scoa',shortTheme:'P√°scoa',posts:0,stories:0,desc:'Chocolates, sobremesas e produtos especiais.'},
    {id:5,name:'Maio',theme:'Dia das M√£es',shortTheme:'M√£es',posts:0,stories:0,desc:'Sobremesas especiais e celebra√ß√µes.'},
    {id:6,name:'Junho',theme:'Festas Juninas',shortTheme:'Junino',posts:0,stories:0,desc:'Produtos t√≠picos e pamonha congelada.'},
    {id:7,name:'Julho',theme:'F√©rias de Inverno',shortTheme:'Inverno',posts:0,stories:0,desc:'Sopas, caldos e comfort food.'},
    {id:8,name:'Agosto',theme:'Dia dos Pais',shortTheme:'Pais',posts:0,stories:0,desc:'Churrascos e produtos especiais.'},
    {id:9,name:'Setembro',theme:'Primavera',shortTheme:'Primavera',posts:0,stories:0,desc:'Renova√ß√£o do card√°pio e lan√ßamentos.'},
    {id:10,name:'Outubro',theme:'Dia das Crian√ßas',shortTheme:'Crian√ßas',posts:0,stories:0,desc:'Salgadinhos e produtos infantis.'},
    {id:11,name:'Novembro',theme:'Black Friday',shortTheme:'Black Friday',posts:0,stories:0,desc:'Promo√ß√µes e estoque para festas.'},
    {id:12,name:'Dezembro',theme:'Natal e R√©veillon',shortTheme:'Festas',posts:0,stories:0,desc:'Alta demanda e produtos premium.'}
];

// POSTS INICIAIS VAZIOS - CARREGAR DO data.json
const INITIAL_POSTS = {};

// ============== VARI√ÅVEIS GLOBAIS ==============
let currentMonth = 1;
let currentTab = 'narrativa';
let currentPost = null;
let dropdownOpen = false;
let POSTS = {};

// ============== STORAGE ==============
function loadFromStorage() {
    try {
        const saved = localStorage.getItem('nechio_posts_2026');
        if (saved) {
            POSTS = JSON.parse(saved);
            console.log('‚úì Dados carregados do localStorage');
        } else {
            POSTS = JSON.parse(JSON.stringify(INITIAL_POSTS));
            // Tentar carregar do data.json automaticamente
            loadDefaultData();
        }
    } catch(e) {
        console.error('Erro ao carregar:', e);
        POSTS = JSON.parse(JSON.stringify(INITIAL_POSTS));
    }
}

function saveToStorage() {
    try {
        localStorage.setItem('nechio_posts_2026', JSON.stringify(POSTS));
        showToast('‚úì Salvo!');
    } catch(e) {
        console.error('Erro ao salvar:', e);
        showToast('‚ùå Erro ao salvar');
    }
}

function exportData() {
    const data = {
        version: '1.0',
        exportDate: new Date().toISOString(),
        months: MONTHS_DATA,
        posts: POSTS
    };
    const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `nechio_backup_${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    showToast('‚úì Backup exportado!');
}

function importData(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(e) {
        try {
            const data = JSON.parse(e.target.result);
            if (data.posts) {
                POSTS = data.posts;
                saveToStorage();
                renderPosts();
                showToast('‚úì Dados importados!');
            }
        } catch(err) {
            showToast('‚ùå Arquivo inv√°lido');
        }
    };
    reader.readAsText(file);
}

// ============== RENDER ==============
function renderMonthSelector() {
    const month = MONTHS_DATA.find(m => m.id === currentMonth);
    document.getElementById('selectorNum').textContent = String(month.id).padStart(2, '0');
    document.getElementById('selectorName').textContent = month.name;
    document.getElementById('selectorTheme').textContent = month.shortTheme;
    
    const dropdown = document.getElementById('monthDropdown');
    dropdown.innerHTML = MONTHS_DATA.map(m => {
        const monthPosts = POSTS[m.id] || [];
        return `
        <div class="month-dropdown-item ${m.id === currentMonth ? 'active' : ''}" onclick="selectMonth(${m.id})">
            <div class="month-dropdown-num">${String(m.id).padStart(2, '0')}</div>
            <div class="month-dropdown-info"><h4>${m.name}</h4><span>${m.shortTheme}</span></div>
            <div class="month-dropdown-posts">${monthPosts.length} posts</div>
        </div>
    `}).join('');
    
    const quickNav = document.getElementById('monthQuickNav');
    quickNav.innerHTML = MONTHS_DATA.map(m => `
        <button class="month-quick-btn ${m.id === currentMonth ? 'active' : ''}" onclick="selectMonth(${m.id})">
            ${m.name.substring(0, 3).toUpperCase()}
        </button>
    `).join('');
    
    const monthPosts = POSTS[currentMonth] || [];
    document.getElementById('statPosts').textContent = monthPosts.length;
    document.getElementById('statStories').textContent = monthPosts.filter(p => p.format && p.format.toLowerCase().includes('story')).length;
    document.getElementById('themeTitle').textContent = month.shortTheme;
    document.getElementById('themeDesc').textContent = month.desc;
}

function toggleDropdown() {
    dropdownOpen = !dropdownOpen;
    document.getElementById('monthSelectorBtn').classList.toggle('open', dropdownOpen);
    document.getElementById('monthDropdown').classList.toggle('open', dropdownOpen);
}

function selectMonth(id) {
    currentMonth = id;
    dropdownOpen = false;
    document.getElementById('monthSelectorBtn').classList.remove('open');
    document.getElementById('monthDropdown').classList.remove('open');
    renderMonthSelector();
    renderPosts();
}

function renderPosts() {
    const month = MONTHS_DATA.find(m => m.id === currentMonth);
    document.getElementById('mainTitle').innerHTML = `${month.name.toUpperCase()} ‚Äî <span>${month.shortTheme}</span>`;
    
    const container = document.getElementById('postsList');
    const posts = POSTS[currentMonth] || [];
    
    if (posts.length === 0) {
        container.innerHTML = `<div class="empty-state"><h3>üì¶ Sem posts ainda</h3><p>Use "Importar" ou "Carregar URL" para adicionar conte√∫do de ${month.name}.</p></div>`;
        return;
    }
    
    const sorted = [...posts].sort((a, b) => new Date(a.date) - new Date(b.date));
    const monthNames = ['JAN','FEV','MAR','ABR','MAI','JUN','JUL','AGO','SET','OUT','NOV','DEZ'];
    
    container.innerHTML = sorted.map(p => {
        const d = new Date(p.date);
        return `
            <div class="post-card" onclick="openModal(${p.id})">
                <div class="post-date">
                    <div class="post-date-day">${String(d.getDate()).padStart(2, '0')}</div>
                    <div class="post-date-month">${monthNames[d.getMonth()]}</div>
                </div>
                <div class="post-info">
                    <div class="post-type">${p.type || 'POST'}</div>
                    <div class="post-title">${p.title}</div>
                    <div class="post-desc">${p.desc || ''}</div>
                    ${p.status === 'completed' ? '<span class="post-status-badge status-completed">‚úì Finalizado</span>' : p.status === 'pending' ? '<span class="post-status-badge status-pending">‚è≥ Pendente</span>' : ''}
                </div>
                <div class="post-format">${p.format || 'Post'}</div>
            </div>
        `;
    }).join('');
}

function openModal(id) {
    const posts = POSTS[currentMonth] || [];
    currentPost = posts.find(p => p.id === id);
    if (!currentPost) return;
    
    document.getElementById('modalBadge').textContent = `POST #${String(currentPost.id).padStart(2, '0')} ¬∑ ${(currentPost.format || 'POST').toUpperCase()}`;
    document.getElementById('modalDate').value = currentPost.date;
    document.getElementById('modalTitle').value = currentPost.title;
    document.getElementById('modalDesc').textContent = currentPost.desc || '';
    
    currentTab = 'narrativa';
    updateTabs();
    renderTabContent();
    
    document.getElementById('modalOverlay').classList.add('show');
    updateStatusButton();
}

function closeModal() {
    document.getElementById('modalOverlay').classList.remove('show');
}

function switchTab(tab) {
    currentTab = tab;
    updateTabs();
    renderTabContent();
}

function updateTabs() {
    document.querySelectorAll('.modal-tab').forEach(t => {
        t.classList.toggle('active', t.dataset.tab === currentTab);
    });
}

function renderTabContent() {
    const body = document.getElementById('modalBody');
    const content = currentPost[currentTab] || 'Conte√∫do n√£o dispon√≠vel';
    const titles = {narrativa:'NARRATIVA/ROTEIRO',imagem:'PROMPTS DE IMAGEM',video:'DIRE√á√ÉO DE V√çDEO',tela:'TEXTO NA TELA',legenda:'LEGENDA INSTAGRAM'};
    const icons = {narrativa:'üìù',imagem:'üñºÔ∏è',video:'üé¨',tela:'üì∫',legenda:'üì±'};
    
    body.innerHTML = `
        <div class="content-section">
            <div class="section-header">
                <div class="section-title ${currentTab}"><span class="section-icon">${icons[currentTab]}</span> ${titles[currentTab]}</div>
                <button class="copy-btn" onclick="copyContent()">üìã Copiar</button>
            </div>
            <div class="section-body">
                <div class="content-text" id="contentText">${content}</div>
            </div>
        </div>
    `;
}

function copyContent() {
    const text = document.getElementById('contentText').textContent;
    navigator.clipboard.writeText(text).then(() => {
        const btn = document.querySelector('.copy-btn');
        btn.classList.add('copied');
        btn.innerHTML = '‚úì Copiado!';
        showToast('‚úì Copiado!');
        setTimeout(() => {
            btn.classList.remove('copied');
            btn.innerHTML = 'üìã Copiar';
        }, 2000);
    });
}

function updatePostDate() {
    const newDate = document.getElementById('modalDate').value;
    if (currentPost && newDate) {
        currentPost.date = newDate;
        saveToStorage();
        renderPosts();
    }
}

function updatePostTitle() {
    const newTitle = document.getElementById('modalTitle').value;
    if (currentPost && newTitle) {
        currentPost.title = newTitle;
        saveToStorage();
        renderPosts();
    }
}

function showToast(msg) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 2000);
}

// ============== DELETAR POST ==============
function deletePost() {
    if (!currentPost) return;
    
    const confirmMsg = `‚ö†Ô∏è DELETAR POST?\n\n"${currentPost.title}"\n\nEsta a√ß√£o n√£o pode ser desfeita.`;
    if (!confirm(confirmMsg)) return;
    
    const monthId = currentMonth;
    const postId = currentPost.id;
    
    POSTS[monthId] = POSTS[monthId].filter(p => p.id !== postId);
    saveToStorage();
    closeModal();
    renderPosts();
    showToast('‚úì Post deletado!');
}

// ============== STATUS FINALIZADO ==============
function togglePostStatus() {
    if (!currentPost) return;
    
    const monthId = currentMonth;
    const postId = currentPost.id;
    
    const post = POSTS[monthId].find(p => p.id === postId);
    if (!post) return;
    
    if (!post.status) post.status = 'pending';
    post.status = post.status === 'completed' ? 'pending' : 'completed';
    currentPost.status = post.status;
    
    saveToStorage();
    updateStatusButton();
    renderPosts();
    
    const statusText = post.status === 'completed' ? 'finalizado' : 'em andamento';
    showToast(`‚úì Post marcado como ${statusText}`);
}

function updateStatusButton() {
    const btn = document.getElementById('statusToggleBtn');
    if (!btn || !currentPost) return;
    
    const status = currentPost.status || 'pending';
    const isCompleted = status === 'completed';
    
    btn.innerHTML = isCompleted ? '‚úì Finalizado' : '‚è≥ Em Andamento';
    btn.className = 'modal-action-btn btn-status ' + (isCompleted ? 'completed' : 'pending');
}

// ============== BAIXAR POST ==============
function downloadPost() {
    if (!currentPost) return;
    
    const monthId = currentMonth;
    
    const postData = {
        version: '1.0',
        exportDate: new Date().toISOString(),
        posts: {
            [monthId]: [currentPost]
        }
    };
    
    const blob = new Blob([JSON.stringify(postData, null, 2)], {
        type: 'application/json'
    });
    
    const safeTitle = currentPost.title
        .replace(/[^a-z0-9]/gi, '_')
        .toLowerCase()
        .substring(0, 30);
    const fileName = `post_${safeTitle}_${currentPost.date}.json`;
    
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = fileName;
    a.click();
    URL.revokeObjectURL(url);
    
    showToast('‚¨áÔ∏è Post baixado: ' + fileName);
}

// ============== GITHUB SYNC ==============
let currentGitHubTab = 'load';

function openGitHubSync() {
    document.getElementById('githubModal').classList.add('show');
}

function closeGitHubModal() {
    document.getElementById('githubModal').classList.remove('show');
    document.getElementById('githubStatus').style.display = 'none';
}

function switchGitHubTab(tab) {
    currentGitHubTab = tab;
    document.querySelectorAll('.github-tab').forEach(t => t.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById('githubLoadTab').style.display = tab === 'load' ? 'block' : 'none';
    document.getElementById('githubPushTab').style.display = tab === 'push' ? 'block' : 'none';
}

function showGitHubStatus(msg, isError = false) {
    const status = document.getElementById('githubStatus');
    status.textContent = msg;
    status.className = 'github-status ' + (isError ? 'error' : 'success');
    status.style.display = 'block';
}

function loadFromURL() {
    openGitHubSync();
}

async function loadFromURLInput() {
    const url = document.getElementById('jsonUrl').value.trim();
    if (!url) {
        showGitHubStatus('‚ùå Digite uma URL v√°lida', true);
        return;
    }
    
    try {
        showGitHubStatus('‚è≥ Carregando...');
        const response = await fetch(url);
        if (!response.ok) throw new Error('Erro ao carregar: ' + response.status);
        const data = await response.json();
        
        if (data.posts) {
            POSTS = data.posts;
            saveToStorage();
            renderMonthSelector();
            renderPosts();
            showGitHubStatus('‚úì Dados carregados com sucesso! ' + Object.keys(POSTS).length + ' meses importados.');
            showToast('‚úì Dados importados da URL!');
        } else {
            throw new Error('JSON inv√°lido - campo "posts" n√£o encontrado');
        }
    } catch(err) {
        showGitHubStatus('‚ùå ' + err.message, true);
    }
}

async function loadDefaultData() {
    try {
        console.log('‚è≥ Carregando data.json local...');
        const response = await fetch('./data.json');
        if (!response.ok) throw new Error('data.json n√£o encontrado');
        const data = await response.json();
        
        if (data.posts) {
            POSTS = data.posts;
            localStorage.setItem('nechio_posts_2026', JSON.stringify(POSTS));
            renderMonthSelector();
            renderPosts();
            console.log('‚úì Dados carregados do data.json local!');
        }
    } catch(err) {
        console.log('‚ÑπÔ∏è data.json n√£o encontrado, usando dados vazios');
    }
}

async function pushToGitHub() {
    const token = document.getElementById('githubToken').value.trim();
    const repo = document.getElementById('githubRepo').value.trim();
    const file = document.getElementById('githubFile').value.trim() || 'data.json';
    
    if (!token || !repo) {
        showGitHubStatus('‚ùå Preencha o token e o reposit√≥rio', true);
        return;
    }
    
    try {
        showGitHubStatus('‚è≥ Conectando ao GitHub...');
        
        const data = {
            version: '1.0',
            exportDate: new Date().toISOString(),
            months: MONTHS_DATA,
            posts: POSTS
        };
        const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
        
        let sha = null;
        try {
            const getResponse = await fetch(`https://api.github.com/repos/${repo}/contents/${file}`, {
                headers: { 'Authorization': `token ${token}` }
            });
            if (getResponse.ok) {
                const existingFile = await getResponse.json();
                sha = existingFile.sha;
            }
        } catch(e) {}
        
        const body = {
            message: `üìä Atualiza√ß√£o Nechio Studio - ${new Date().toLocaleDateString('pt-BR')}`,
            content: content
        };
        if (sha) body.sha = sha;
        
        const response = await fetch(`https://api.github.com/repos/${repo}/contents/${file}`, {
            method: 'PUT',
            headers: {
                'Authorization': `token ${token}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(body)
        });
        
        if (!response.ok) {
            const error = await response.json();
            throw new Error(error.message || 'Erro ao atualizar');
        }
        
        showGitHubStatus('‚úì Arquivo atualizado com sucesso no GitHub! üéâ');
        showToast('‚úì GitHub atualizado!');
        
    } catch(err) {
        showGitHubStatus('‚ùå ' + err.message, true);
    }
}

// ============== INIT ==============
document.addEventListener('DOMContentLoaded', () => {
    loadFromStorage();
    renderMonthSelector();
    renderPosts();
});

document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
document.getElementById('modalOverlay').addEventListener('click', e => { if (e.target.id === 'modalOverlay') closeModal(); });
document.addEventListener('click', e => {
    if (!e.target.closest('.month-selector') && dropdownOpen) {
        dropdownOpen = false;
        document.getElementById('monthSelectorBtn').classList.remove('open');
        document.getElementById('monthDropdown').classList.remove('open');
    }
});
</script>
</body>
</html>
